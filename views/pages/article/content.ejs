<div id="contentContent">
  <div class="row">
    <% if ('undefined' !== typeof rights &&
       'admin' == rights) { %>
    <div class="col-xs-6">
      <a href="/article/edit" class="btn btn-primary" style="display:block;"><span class="glyphicon glyphicon-asterisk"></span> Create article</a>
    </div>
    <% } %>
    <% if ('undefined' !== typeof article) { %>
    <% if ('undefined' !== typeof rights &&
       'admin' == rights) { %>
    <div class="col-xs-6">
      <a href="/article/edit/<%= article.technicalName %>" class="btn btn-primary" style="display:block;"><span class="glyphicon glyphicon-pencil"></span> Edit article</a>
    </div>
    <br />
    <br />
    <% } %>
  </div>

  <a href="<%= article.img %>"><img src="<%= article.img %>" alt="<%= article.img %>" style="max-width:100%;" /></a>
  <h2>
    <%- article.title %>
  </h2>
  <h4 style="margin-left:10%;">
    by <a href="/user/<%= article.author %>"><%= article.author %></a>,<br/>
    <small>
      <%= ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][article.lastUpdated.getDay()] %>,
      <%= ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][article.lastUpdated.getMonth()] %>
      <%= article.lastUpdated.getDate() %><sup><%= ['st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st'][article.lastUpdated.getDate() - 1] %></sup>
      <%= article.lastUpdated.getFullYear() %>
    </small>
  </h4>
  <p><i>
      <%- article.caption %>
  </i></p>
  <br />
  <div style="overflow:hidden;">
    <%- article.content %>
  </div>
  <div>
    <% for (var i = 0 ; article.tags.length > i ; ++i) { %>
    <span class="label label-primary"><%= article.tags[i] %></span>
    <% } %>
  </div>
  <br />

  <h3>Comments</h3>

  <div class="alert alert-info">
    <h4 style="cursor:pointer;margin-bottom:0;" onclick="$(this).siblings('form').slideToggle();">Add a comment</h4>
    <form method="POST" action="/article/addComment" style="display:none;">
      <div>
	<label for="commentAuthorAlias">
	  <% if ('undefined' !== typeof login) { %>
	  <%= login %>
	  <% } else { %>
	  Anonymous
	  <% } %>
	</label> as&nbsp;
	<% if ('undefined' !== typeof previousFormData &&
	   'undefined' !== typeof previousFormData.authorAlias) { %>
	<input type="text" name="authorAlias" id="commentAuthorAlias" class="form-control" value="<%= previousFormData.authorAlias %>" placeholder="Display name..." style="display:inline-block;min-width:40px;width:auto;" />
	<% } else { %>	
	<input type="text" name="authorAlias" id="commentAuthorAlias" class="form-control" placeholder="Display name..." style="display:inline-block;min-width:40px;width:auto;" />
	<% } %>
      </div>
      <br />
      <textarea name="commentText" class="form-control" placeholder="Great article!"><% if ('undefined' !== typeof previousFormData && 'undefined' !== typeof previousFormData.commentText) { %><%- previousFormData.commentText %><% } %></textarea>
	<% if ('undefined' !== typeof previousFormData &&
	   'undefined' !== typeof previousFormData.tags) { %>
	<input type="text" name="tags" class="form-control" value="<%= previousFormData.tags %>" placeholder="Optionally, tags..." />
	<% } else { %>
	<input type="text" name="tags" class="form-control" placeholder="Optionally, tags..." />
	<% } %>
      <br />
      <input type="hidden" name="articleId" value="<%= article._id %>" />
      <button type="submit" class="btn btn-success pull-right">Submit <span class="glyphicon glyphicon-ok"></span></button>
      <div style="clear:both;"></div>
    </form>
  </div>

  <% if ('undefined' !== typeof comments) { %>
  <% for (var i = 0 ; comments.length > i ; ++i) {
  var comment = comments[i]; %>
  <div class="well" style="margin:0 0 4px 0;padding:1%;">
    <h4 style="margin:0;"><%- (comment.author ? '<a href="/user/' + comment.author + '">' + comment.author + '</a>' : 'Anonymous') %><%- comment.authorAlias ? ' as <span class="text text-success">' + comment.authorAlias + '</span>' : '' %></h4>
    <h5 style="margin:0;padding:0 10%;">
      <small>
	<%= ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][comment.created.getDay()] %>,
	<%= ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][comment.created.getMonth()] %>
	<%= comment.created.getDate() %><sup><%= ['st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st'][comment.created.getDate() - 1] %></sup>
	<%= comment.created.getFullYear() %>
      </small>
    </h5>
    <p>
      <%- comment.content %>
    </p>
    <div>
      <% for (var j = 0 ; comment.tags.length > j ; ++j) { %>
      <span class="label label-primary"><%= comment.tags[j] %></span>
      <% } %>
    </div>
  </div>
  <% } %>
  <% } %>

  <% } %>
</div>
